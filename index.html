<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>故宫寻宝：神兽大作战</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
</head>
<script src="app.js"></script>
<body>
    <div class="container">
        <header>
            🏯 故宫寻宝：神兽大作战 🏯
        </header>
        <main>
            <!-- 1. 首页 -->
            <section id="home-page" class="page active">
                <h2>寻找失落的"九龙玉玺"</h2>
                        <img class="home-hero" src="img/tahe.jpg" alt="故宫太和殿">
                <div class="story-intro">
                    <p>✨ <strong>小皇帝的九龙玉玺被淘气的神兽们藏起来啦！</strong></p>
                    <p>勇敢的小朋友，你需要去故宫的五个重要地方，找到守护神兽，完成它们指定的任务（打卡合照），就能获得一枚神兽徽章和一条关于玉玺的线索。</p>
                    <p>集齐所有徽章，拼出藏宝图，找到玉玺，你就是<strong>故宫小英雄！</strong>🎉</p>
                </div>
                <div class="badge-collection">
                    <h3>我的徽章</h3>
                    <div id="badge-grid" class="badge-scroll"></div>
                </div>
                <button class="start-button" onclick="showPage('list-page')">开始寻宝！</button>
            </section>

            <!-- 2. 打卡点列表页 -->
            <section id="list-page" class="page">
                <h2>神兽徽章收集进度</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%">
                        <span id="progress-text">0/5</span>
                    </div>
                </div>
                <div class="map-actions"
                    style="display:flex; gap:10px; margin-bottom:12px; justify-content:space-between; align-items:center;">
                    <div>
                        <button class="start-button" style="padding:10px 16px; font-size:1em; margin:0;"
                            onclick="resetToCheckpoints()">🗺️ 回到打卡区域</button>
                    </div>
                    <div>
                        <button class="start-button" style="padding:10px 16px; font-size:1em; margin:0;"
                            onclick="locateMe()">📍 定位到我</button>
                    </div>
                </div>
                <div id="map"
                    style="width:100%; height: 420px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);">
                </div>
                <div class="badge-strip" style="margin: 12px 0 0 0;">
                    <div id="list-badge-grid" class="badge-scroll"></div>
                </div>
                <div id="reward-prompt" style="text-align: center; margin-top: 20px; display: none;">
                    <button class="start-button" onclick="showPage('reward-page')">领取终极奖励！</button>
                </div>
            </section>

            <!-- 3. 打卡详情页 -->
            <section id="detail-page" class="page">
                <h2 id="detail-title"></h2>
                <img id="detail-image" class="detail-image" src="" alt="景点图片">
                <div class="detail-knowledge" id="detail-knowledge"></div>

                <div class="pose-box">
                    <h4>🎭 神兽任务：打卡Pose要求</h4>
                    <p class="pose-text" id="detail-pose"></p>
                </div>

                <div class="task-box">
                    <h4 style="color:#8B0000;margin:0 0 8px 0;">📷 上传合照</h4>
                    <div class="photo-row">
                        <img id="photo-preview" class="photo-preview" src="" alt="预览">
                        <input id="photo-input" type="file" accept="image/*" capture="environment">
                    </div>
                </div>

                <div class="task-box">
                    <h4 style="color:#8B0000;margin:0 0 8px 0;">❓ 回答小问答</h4>
                    <img id="quiz-image" class="quiz-image" src="" alt="问题配图" style="display:none;">
                    <div id="quiz-question" style="font-weight:bold; color:#333; margin-bottom:6px;"></div>
                    <ul id="quiz-options" class="quiz-options"></ul>
                    <div id="quiz-hint" class="quiz-hint"></div>
                    <div id="quiz-feedback" style="color:#DC143C; font-weight:bold; margin-top:6px;"></div>
                </div>

                <button class="action-button check-in-button" id="check-in-btn"
                    onclick="completeCheckpoint()">我已合影，完成打卡！</button>
                <button class="action-button back-button" onclick="showPage('list-page')">返回列表</button>
            </section>

            <!-- 4. 终极奖励页 -->
            <section id="reward-page" class="page">
                <div class="trophy">🏆</div>
                <h2>恭喜你，故宫小英雄！</h2>
                <p style="font-size: 1.1em; margin-top: 15px;">你集齐了所有神兽徽章，成功拼出了藏宝图！</p>

                <div class="certificate">
                    <h2>🎖️ 故宫小英雄证书 🎖️</h2>
                    <p>特此授予 <strong>勇敢的寻宝者</strong></p>
                    <p><strong>"故宫小英雄"</strong>称号！</p>
                    <p style="margin-top: 15px; font-size: 1em;">你成功完成了故宫定向越野挑战，获得了所有神兽的认可，并找回了失落的九龙玉玺！</p>
                        <img id="seal-image" class="seal-image" src="img/九龙玉玺.jpg" alt="九龙玉玺图片">
                    <p style="margin-top: 15px; color: #8B0000; font-weight: bold;">🎁 你已获得"故宫小英雄"的荣誉！</p>
                </div>
                <p style="margin-top: 20px; font-size: 1.05em;">希望你在故宫的寻宝之旅中，学到了很多有趣的知识！下次再来故宫时，别忘了这些神兽朋友哦！👋</p>
                <button class="start-button" style="margin-top: 20px;" onclick="resetGame()">重新开始</button>
            </section>
        </main>
    </div>

    <!-- Leaflet 脚本 -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
</body>

</html>